{
    "data_config": {
        "dataloader_config": {
            "batch_size": 1,
            "num_workers": 1,
            "shuffle": true
        },
        "dataset_config": {
            "cache_bev": false,
            "dataset_file": "train.txt",
            "root_path": "/data/object/training",
            "classes": ["Car"],
            "bev_generator_config": {
                "height_lo": -0.2,
                "height_hi": 2.3,
                "num_slices": 5,
                "voxel_size": 0.1
            },
            "area_extents": [[-40, 40], [-5, 3], [0, 70.4]]
        },
        "name": "kitti",
        "transform_config": {
            "input_size":{
                "bev_input_size":[700,800],
                "img_input_size": [
                    360,
                    1200
                ]
            },
            "normal_mean": [
                0.485,
                0.456,
                0.406
            ],
            "normal_van": [
                0.229,
                0.224,
                0.225
            ],
            "random_blur": 0,
            "random_brightness": 10,
            "resize_range": [
                0.2,
                0.4
            ]
        }
    },
    "eval_config": {
        "batch_size": 1,
        "bbox_normalize_means": [
            0.0,
            0.0,
            0.0,
            0.0
        ],
        "bbox_normalize_stds": [
            0.1,
            0.1,
            0.2,
            0.2
        ],
        "bbox_normalize_targets_precomputed": true,
        "bbox_reg": true,
        "class_agnostic": true,
        "classes": [
            "bg",
            "Car"
        ],
        "eval_out": "./results/data",
        "eval_out_anchors":"./results/anchors",
        "eval_out_rois":"./results/rois",
        "max_per_image": 100,
        "nms": 0.3,
        "rng_seed": 3,
        "thresh": 0.5
    },
    "eval_data_config": {
        "dataloader_config": {
            "batch_size": 1,
            "num_workers": 1,
            "shuffle": false
        },
        "dataset_config": {
            "cache_bev": false,
            "dataset_file": "val.txt",
            "root_path": "/data/object/training",
            "classes": ["Car"],
            "bev_generator_config": {
                "height_lo": -0.3,
                "height_hi": 3.7,
                "num_slices": 5,
                "voxel_size": 0.1
            },
            "area_extents": [[-40, 40], [-5, 3], [0, 70.4]]
        },
        "name": "kitti",
        "transform_config": {
            "input_size":{
                "bev_input_size":[700,800],
                "img_input_size": [
                    360,
                    1200
                ]
            },
            "normal_mean": [
                0.485,
                0.456,
                0.406
            ],
            "normal_van": [
                0.229,
                0.224,
                0.225
            ]
        }
    },
    "model_config": {
        "nms_thresh":0.01,
        "path_drop_probabilities":[1.0,1.0],
        "area_extents": [[-40, 40], [-5, 3], [0, 70.4]],
        "fc_output_layer_config":{
            "fusion_method":"concat",
            "num_classes":2,
            "layer_size":[2048,2048,2048],
            "ndin": 1568,
            "keep_prob":0.5,
            "ang_out_size":2,
            "off_out_size":6
        },
        "expand_proposals_xz":0,
        "class_agnostic": true,
        "classes": [
            "bg",
            "Car"
        ],
        "feature_extractor_config": {
            "pooling_size":7,
            "class_agnostic": true,
            "classes": [
                "bg",
                "Car"
            ],
            "img_channels": 3,
            "pretrained_model": "data/pretrained_model/resnet50-19c8e357.pth",
            "pretrained": true,
            "use_cascade": true
        },
        "num_classes": 2,
        "pooling_mode": "align",
        "pooling_size": 7,
        "rcnn_batch_size": 64,
        "rpn_config": {
            "truncated":true,
            "img_filter_topN": -1,
            "use_empty_filter":false,
            "img_filter_iou_thresh":0,
            "enable_img_filter":false,
            "voxel_size":0.1,
            "anchor_predictor_config":{
                "keep_prob":0.5,
                "pooling_size":3
            },
            "num_classes":2,
            "bev_feature_extractor_config":{"input_mode":"bev","l2_weights_decay":0.1,"ndin":6},
            "img_feature_extractor_config":{"input_mode":"img","l2_weights_decay":0.1,"ndin":3},
            "path_drop_probabilities":[1.0,1.0],
            "fusion_method":"mean",
            "voxel_generator_config":{},
            "pooling_size":3,
            "use_focal_loss":false,
            "area_extents": [[-40, 40], [-5, 3], [0, 70.4]],
            "anchor_generator_config": {
                "area_extents": [[-40, 40], [-5, 3], [0, 70.4]],
                "anchor_offset": [
                    0,
                    0
                ],
                "anchor_stride": [
                    0.5,
                    0.5
                ],
                "anchor_size":[[3.4, 1.7, 1.5]]
            },
            "din": 1024,
            "min_size": 16,
            "nms_thresh": 0.7,
            "num_bbox_samples": 500,
            "num_cls_samples": 2000,
            "post_nms_topN": 1000,
            "pre_nms_topN": 2000,
            "rpn_batch_size": 512,
            "sampler_config": {
                "fg_fraction": 0.5
            },
            "target_assigner_config": {
                "similarity_calc_config":{
                    "type":"center"
                },
                "fg_thresh": 0.5,
                "bg_thresh":0.3,
                "coder_config": {
                    "type":"avod",
                    "bbox_normalize_targets_precomputed": false
                },
                "matcher_config": {
                    "type": "bipartitle"
                }
            },
            "use_score": false
        },
        "sampler_config": {
            "fg_fraction": 0.5
        },
        "target_assigner_config": {
            "similarity_calc_config":{
                "type":"center"
            },
            "fg_thresh": 0.5,
            "bg_thresh": 0.5,
            "coder_config": {
                "type":"avod",
                "bbox_inside_weights": [
                    1.0,
                    1.0,
                    1.0,
                    1.0
                ],
                "bbox_normalize_means": [
                    0.0,
                    0.0,
                    0.0,
                    0.0
                ],
                "bbox_normalize_stds": [
                    0.1,
                    0.1,
                    0.2,
                    0.2
                ],
                "bbox_normalize_targets_precomputed": true
            },
            "matcher_config": {
                "type": "argmax"
            }
        },
        "truncated": false,
        "use_focal_loss": false
    },
    "train_config": {
        "checkpoint_interval": 10000,
        "clip_gradient": 10,
        "device_ids": [
            0
        ],
        "disp_interval": 50,
        "mGPUs": true,
        "max_epochs": 1000,
        "optimizer_config": {
            "lr": 0.001,
            "momentum": 0.9,
            "type": "sgd",
            "weight_decay":0.005
        },
        "rng_seed": 3,
        "scheduler_config": {
            "last_epoch": -1,
            "lr_decay_gamma": 0.1,
            "lr_decay_step": 50,
            "type": "step"
        },
        "start_epoch": 1
    }
}
